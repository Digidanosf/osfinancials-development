update totals set FAmount = 
(select sum(FAmount) from transact join account on (transact.waccountid = account.Waccountid)
where account.BIncomeExpense = 0 and transact.Waccountid = Totals.Waccountid 
and TRANSACT.wperiodid < 0)
where  totals.WPeriodid = -1 and totals.Bactual = 1;