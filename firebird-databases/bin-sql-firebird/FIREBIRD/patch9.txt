CREATE TABLE IMP_SOURCE(
IMP_SOURCEID Integer NOT NULL,
IMP_NAME varchAr(35) NOT NULL,
IMP_OSFINANCIALS_PHP_URL varchAr(250),
IMP_DEBTORURL varchAr(250) ,
IMP_CREDITORURL varchAr(250) ,
IMP_STOCKURL varchAr(250) ,
IMP_DOCUMENTURL varchAr(250),
IMP_EVENTURL varchAr(250),
IMP_CONTACTURL varchAr(250),
IMP_SOURCE_LOGICTYPE Integer,
IMP_USERNAME varchAr(50) ,
IMP_PASSWORD varchAr(50) ,
IMP_PREFIX varchAr(10),
IMP_INIFILE {blobtexttype} ,
CONSTRAINT PK_IMP_SOURCE PRIMARY KEY (IMP_SOURCEID) 
);
CREATE TABLE IMP_LINK(
  IMP_LINKID Integer NOT NULL,
  IMP_SOURCEID Integer NOT NULL,
  IMP_EXTID varchAr(60) NOT NULL ,
  WACCOUNTID Integer,
  WDOCID Integer,
  WSTOCKID Integer,
  WContactID Integer,
  WEventID Integer,
  CONSTRAINT PK_IMP_LINK PRIMARY KEY (IMP_LINKID)
);
ALTER TABLE IMP_LINK ADD CONSTRAINT FK_IMP_LINK_ACC  
FOREIGN KEY (WACCOUNTID) REFERENCES ACCOUNT (WACCOUNTID) ON DELETE CASCADE;
ALTER TABLE IMP_LINK ADD CONSTRAINT FK_IMP_LINK_DOC
FOREIGN KEY (WDOCID) REFERENCES DOCHEAD (WDOCID) ON DELETE CASCADE;
ALTER TABLE IMP_LINK ADD CONSTRAINT FK_IMP_LINK_SOURCE
FOREIGN KEY (IMP_SOURCEID) REFERENCES IMP_SOURCE (IMP_SOURCEID) ON DELETE CASCADE;
ALTER TABLE IMP_LINK ADD CONSTRAINT FK_IMP_LINK_STO
  FOREIGN KEY (WSTOCKID) 
REFERENCES STOCK (WSTOCKID) ON DELETE CASCADE;
CREATE INDEX IDX_IMP_LINKEXTID ON IMP_LINK (IMP_SOURCEID,IMP_EXTID);
CREATE INDEX IDX_IMP_LINKWACCID ON IMP_LINK (WACCOUNTID);
CREATE INDEX IDX_IMP_LINKWDOCID ON IMP_LINK (WDOCID);
CREATE INDEX IDX_IMP_LINKWSTOID ON IMP_LINK (WSTOCKID);
{generator_cr_start}GEN_LINKID{generator_cr_end} ;
 

CREATE TABLE IMP_STOCKACCOUNTS(
  IMP_STOCKACCOUNTSID Integer NOT NULL,
  IMP_SOURCEID Integer NOT NULL,
  IMP_EXTID varchAr(60) NOT NULL  ,
  WSalesACCOUNTID Integer,
  WCostOfSalesACCOUNTID Integer,
  WStockACCOUNTID Integer,
  WInputTaxACCOUNTID Integer,
  WOutputTaxACCOUNTID Integer,
  CONSTRAINT PK_IMP_STOCKACCOUNTS PRIMARY KEY (IMP_STOCKACCOUNTSID)
);
ALTER TABLE IMP_STOCKACCOUNTS ADD CONSTRAINT FK_IMP_STOCKACCOUNTS_SaleACC
  FOREIGN KEY (WSalesACCOUNTID) REFERENCES ACCOUNT (WACCOUNTID) ON DELETE CASCADE;
ALTER TABLE IMP_STOCKACCOUNTS ADD CONSTRAINT FK_IMP_STOCKACCOUNTS_StockACC
  FOREIGN KEY (WStockACCOUNTID) REFERENCES ACCOUNT (WACCOUNTID) ON DELETE CASCADE;
ALTER TABLE IMP_STOCKACCOUNTS ADD CONSTRAINT FK_IMP_STOCKACCOUNTS_COSACC
  FOREIGN KEY (WCostOfSalesACCOUNTID) REFERENCES ACCOUNT (WACCOUNTID) ON DELETE CASCADE;
ALTER TABLE IMP_STOCKACCOUNTS ADD CONSTRAINT FK_IMP_STOCKACCOUNTS_IntaxACC
  FOREIGN KEY (WInputTaxACCOUNTID) REFERENCES ACCOUNT (WACCOUNTID) ON DELETE CASCADE;
ALTER TABLE IMP_STOCKACCOUNTS ADD CONSTRAINT FK_IMP_STOCKACCOUNTS_OuttaxACC
  FOREIGN KEY (WOutputTaxACCOUNTID) REFERENCES ACCOUNT (WACCOUNTID) ON DELETE CASCADE;
CREATE INDEX IDX_IMP_STOCKACCOUNTSEXTID ON IMP_STOCKACCOUNTS (IMP_SOURCEID,IMP_EXTID);
{generator_cr_start}GEN_IMP_STOCKACCOUNTSID{generator_cr_end} ; 
 
{if InterBase}CREATE TRIGGER ACCOUNT_DDATE FOR ACCOUNT
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS 
BEGIN 
	new.dSysdate = CURRENT_DATE {scriptstddelim}
END{endif};
{if InterBase} CREATE TRIGGER DOCHEAD_DDATE FOR CONTACTS
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS  
BEGIN 
	new.dSysdate = CURRENT_DATE  {scriptstddelim}
END{endif};
{if InterBase}CREATE TRIGGER STOCK_DDATE FOR STOCK
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS  
BEGIN 
	new.dSysdate = CURRENT_DATE  {scriptstddelim}
END{endif};
{if InterBase}CREATE TRIGGER DOCHEAD_DDATE FOR DOCHEAD
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS  
BEGIN 
	new.dSysdate = CURRENT_DATE {scriptstddelim}
END{endif};
{if InterBase}CREATE TRIGGER TRANSACT_DDATE FOR TRANSACT
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS  
BEGIN 
	new.dSysdate = CURRENT_DATE {scriptstddelim}
END{endif};
{if InterBase}CREATE TRIGGER TOTALS_DDATE FOR TOTALS
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS 
BEGIN 
	new.dSysdate = CURRENT_DATE {scriptstddelim}
END{endif};

